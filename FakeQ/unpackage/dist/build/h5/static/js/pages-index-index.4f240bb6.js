(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-index"],{"418e":function(i,t,e){"use strict";var n;e.d(t,"b",(function(){return a})),e.d(t,"c",(function(){return r})),e.d(t,"a",(function(){return n}));var a=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("v-uni-view",{staticClass:"content animate__animated animate__fadeIn animate__faster"},[e("v-uni-view",{staticClass:"top-bar"},[e("v-uni-navigator",{staticClass:"top-bar-left",attrs:{url:"../userhome/userhome?id="+i.uid,"hover-class":"none"}},[e("v-uni-image",{attrs:{src:i.imgurl}})],1),e("v-uni-view",{staticClass:"top-bar-right"},[e("v-uni-view",{staticClass:"search",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.toSearch.apply(void 0,arguments)}}},[e("i",{staticClass:"iconfont icon-searchsousuo"})]),e("v-uni-view",{staticClass:"add"},[e("i",{staticClass:"iconfont icon-jia"})])],1)],1),e("v-uni-view",{staticClass:"search-box"},[e("v-uni-input",{attrs:{type:"text",value:"",placeholder:"从搜索好友开始..."},on:{focus:function(t){arguments[0]=t=i.$handleEvent(t),i.toSearch.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"main"},[i.refresh?e("v-uni-view",{staticClass:"refresh"},[e("i",{staticClass:"iconfont icon-jiazaizhong3"}),e("v-uni-view",{staticClass:"refresh-title"},[i._v("下拉刷新")])],1):i._e(),i.requestData>0?e("v-uni-view",{staticClass:"apply",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.goReq.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"friend-list"},[e("v-uni-view",{staticClass:"friend-list-l"},[e("v-uni-view",{staticClass:"tip"},[i._v(i._s(i.requestData))]),e("i",{staticClass:"iconfont icon-profile"})],1),e("v-uni-view",{staticClass:"friend-list-r"},[e("v-uni-view",{staticClass:"top"},[e("v-uni-view",{staticClass:"name"},[i._v("好友申请")]),e("v-uni-view",{staticClass:"time"},[i._v(i._s(i.changeTime(i.requestTime)))])],1),e("v-uni-view",{staticClass:"news"},[i._v("您有新的好友：快加老子！！")])],1)],1)],1):i._e(),e("v-uni-view",{staticClass:"friends"},i._l(i.friends,(function(t,n){return e("v-uni-view",{key:t.id,staticClass:"friend-list",on:{click:function(e){arguments[0]=e=i.$handleEvent(e),i.toChatRoom(t)}}},[e("v-uni-view",{staticClass:"friend-list-l"},[t.tip>0?e("v-uni-view",{staticClass:"tip"},[i._v(i._s(t.tip))]):i._e(),e("v-uni-image",{attrs:{src:t.imgurl,mode:""}})],1),e("v-uni-view",{staticClass:"friend-list-r"},[e("v-uni-view",{staticClass:"top"},[e("v-uni-view",{staticClass:"name"},[i._v(i._s(t.name))]),e("v-uni-view",{staticClass:"time"},[i._v(i._s(i.changeTime(t.lastTime)))])],1),e("v-uni-view",{staticClass:"news"},[i._v(i._s(t.msg))])],1)],1)})),1)],1),e("myFootBar",{attrs:{pageIndex:i.pageIndex}})],1)},r=[]},"6ef9":function(i,t,e){"use strict";var n=e("4ea4");e("a15b"),e("a434"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(e("f5ec"));var a=n(e("1059")),r=n(e("9809")),s={data:function(){return{pageIndex:0,friends:[],groups:[],uid:"",imgurl:"",token:"",refresh:!1,requestData:"",requestTime:""}},components:{myFootBar:r.default},onLoad:function(){this.getStorages(),this.getFriends(),this.friendReq(),this.join(this.uid),this.receiveSocketMsg()},onPullDownRefresh:function(){this.friends=[],this.getStorages(),this.getFriends(),this.friendReq(),setTimeout((function(){uni.stopPullDownRefresh()}),2e3)},methods:{join:function(i){this.socket.emit("login",i)},receiveSocketMsg:function(){var i=this;this.socket.on("msg",(function(t,e){var n="";0==t.types?n=t.msg:1==t.types?n="[图片消息]":2==t.types?n="[语音消息]":3==t.types&&(n="[分享位置]");for(var a=0;a<i.friends.length;a++)if(i.friends[a].id==e){var r=i.friends[a];r.lastTime=new Date,r.msg=n,r.tip++,i.friends.splice(a,1),i.friends.unshift(r)}}))},getLastMsg:function(i,t){var e=this;uni.request({url:this.serverUrl+"/index/getlastmsg",data:{uid:this.uid,fid:i[t].id,token:this.token},method:"POST",success:function(n){var a=n.data.status,r=n.data.result;if(200===a){0===r.type||(1===r.type?r.message="[图片消息]":2===r.type?r.message="[语音消息]":3===r.type&&(r.message="[分享位置]"));var s=i[t];s.msg=r.message,i.splice(t,1,s)}else 500===a?uni.showToast({title:"服务器出错了...",icon:"none",duration:1500}):300===a&&uni.navigateTo({url:"/pages/signin/signin?name="+e.myname})}})},getUnread:function(i,t){var e=this;uni.request({url:this.serverUrl+"/index/unreadmsg",data:{uid:this.uid,fid:i[t].id,token:this.token},method:"POST",success:function(n){var a=n.data.status,r=n.data.result;if(200===a){var s=i[t];s.tip=r,i.splice(t,1,s)}else 500===a?uni.showToast({title:"服务器出错了...",icon:"none",duration:1500}):300===a&&uni.navigateTo({url:"/pages/signin/signin?name="+e.myname})}})},getFriends:function(){var i=this;uni.request({url:this.serverUrl+"/index/getfriend",data:{uid:this.uid,state:0,token:this.token},method:"POST",success:function(t){var e=t.data.status,n=t.data.result;if(200===e){if(n.result.length>0){for(var r=0;r<n.result.length;r++)n.result[r].imgurl=i.serverUrl+n.result[r].imgurl,n.result[r].markname&&(n.result[r].name=n.result[r].markname);i.friends=n.result}i.friends=a.default.mySort(i.friends,"lastTime",0);for(var s=0;s<i.friends.length;s++)i.getLastMsg(i.friends,s),i.getUnread(i.friends,s);uni.stopPullDownRefresh()}else 500===e?uni.showToast({title:"服务器出错了...",icon:"none",duration:1500}):300===e&&uni.navigateTo({url:"/pages/signin/signin?name="+i.myname})}})},getGroups:function(){var i=this;uni.request({url:this.serverUrl+"/index/getgroup",data:{uid:this.uid,token:this.token},method:"POST",success:function(t){var e=t.data.status,n=t.data.result;if(200===e){if(n.length>0){for(var a=0;a<n.result.length;a++)n.result[a].imgurl=i.serverUrl+n.result[a].imgurl;i.friends=n.result}}else 500===e?uni.showToast({title:"服务器出错了...",icon:"none",duration:1500}):300===e&&uni.navigateTo({url:"/pages/signin/signin?name="+i.myname})}})},friendReq:function(){var i=this;uni.request({url:this.serverUrl+"/index/getfriend",data:{uid:this.uid,state:1,token:this.token},method:"POST",success:function(t){var e=t.data.status,n=t.data.result;if(200===e){i.requestData=n.length;for(var a=0;a<n.length;a++)i.requestTime<n[a].lastTime&&(i.requestTime=n[a].lastTime)}else 500===e?uni.showToast({title:"服务器出错了...",icon:"none",duration:1500}):300===e&&uni.navigateTo({url:"/pages/signin/signin?name="+i.myname})}})},changeTime:function(i){return a.default.dataTime(i)},getStorages:function(){try{var i=uni.getStorageSync("user");i?(this.uid=i.id,this.imgurl=this.serverUrl+"/"+i.imgurl,this.token=i.token):uni.navigateTo({url:"../signin/signin"})}catch(t){}},toChatRoom:function(i){uni.navigateTo({url:"../chatroom/chatroom?id="+i.id+"&name="+i.name+"&img="+i.imgurl+"&type="+i.type})},goReq:function(){uni.navigateTo({url:"../friendapply/friendapply"})},toSearch:function(){uni.navigateTo({url:"../search/search"})}}};t.default=s},8270:function(i,t,e){"use strict";var n=e("ebc6"),a=e.n(n);a.a},9304:function(i,t,e){var n=e("24fb");t=n(!1),t.push([i.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */\r\n/* 公共样式 */.contents[data-v-669e11d6]{padding-top:0}\r\n/* 顶部 */.top-bar[data-v-669e11d6]{z-index:100;width:92%;height:%?88?%;position:fixed;top:0;left:0;background:hsla(0,0%,100%,.96);border-bottom:%?1?% solid rgba(39,20,50,.1);padding-left:%?32?%;padding-right:%?32?%;padding-top:0;box-shadow:%?1?% %?1?% %?20?% %?2?% rgba(117,112,117,.2)}.top-bar .top-bar-left[data-v-669e11d6]{float:left}.top-bar .top-bar-left uni-image[data-v-669e11d6]{width:%?68?%;height:%?68?%;margin-top:%?10?%;border-radius:%?16?%}.top-bar .top-bar-center[data-v-669e11d6]{float:left}.top-bar .top-bar-center .logo[data-v-669e11d6]{display:inline-block;padding-top:%?18?%;font-size:%?24?%;color:#ffe431}.top-bar .top-bar-center .title[data-v-669e11d6]{line-height:%?88?%}.top-bar .top-bar-right[data-v-669e11d6]{float:right;box-shadow:%?8?% %?10?% %?25?% %?-5?% rgba(117,112,117,.3);border-radius:%?40?%}.top-bar .top-bar-right .search[data-v-669e11d6]{display:inline-block;width:%?70?%;height:%?78?%;padding-left:%?12?%}.top-bar .top-bar-right .add[data-v-669e11d6]{width:%?78?%;height:%?78?%;display:inline-block}.top-bar .top-bar-right i[data-v-669e11d6]{width:%?52?%;height:%?52?%;display:inline-block;font-size:%?19?%;padding:%?24?% %?5?% %?5?% %?15?%}\r\n/* 底部 */.bottom[data-v-669e11d6]{position:fixed;bottom:%?20?%;width:100%;height:%?104?%;box-sizing:border-box;padding:%?12?% %?32?%;padding-bottom:env(safe-area-inset-bottom)}.bottom .bottom-btn[data-v-669e11d6]{height:%?80?%;margin:0 auto;background:#ffe431;border-radius:%?20?%;text-align:center;line-height:%?80?%;font-size:%?32?%;color:#272832}.btn1[data-v-669e11d6]{height:%?80?%;border-radius:%?20?%;text-align:center;line-height:%?80?%;font-size:%?32?%;color:#272832}.top-bar[data-v-669e11d6]{background:#ffe431}.top-bar .top-bar-right[data-v-669e11d6]{margin-top:%?4?%}\r\n/* 搜索框 */.search-box[data-v-669e11d6]{width:90%;height:%?42?%;padding-top:%?104?%;padding-bottom:%?16?%;margin:0 auto}.search-box uni-input[data-v-669e11d6]{padding:%?6?% 0;text-align:center;border-radius:%?20?%;background-color:#f3f4f6;box-shadow:%?8?% %?10?% %?25?% %?-5?% rgba(117,112,117,.3)}\r\n/* 好友列表 */.main[data-v-669e11d6]{width:100%;padding-top:%?8?%}.main .refresh[data-v-669e11d6]{text-align:center;padding-top:%?20?%}.main .refresh i[data-v-669e11d6]{font-size:%?32?%;color:rgba(39,40,50,.8)}.main .refresh .refresh-title[data-v-669e11d6]{padding-top:%?10?%;font-size:%?28?%;color:rgba(39,40,50,.4);line-height:%?40?%}.main .apply .friend-list[data-v-669e11d6],\r\n.main .friends .friend-list[data-v-669e11d6]{height:%?96?%;padding:%?16?% %?32?%}.main .apply .friend-list[data-v-669e11d6]:active,\r\n.main .friends .friend-list[data-v-669e11d6]:active{background-color:#f3f4f6}.main .apply .friend-list .friend-list-l[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-l[data-v-669e11d6]{position:relative;float:left}.main .apply .friend-list .friend-list-l i[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-l i[data-v-669e11d6]{font-size:%?33?%;border:%?1?% solid rgba(39,20,50,.1);display:inline-block;width:%?96?%;height:%?96?%;line-height:%?96?%;text-align:center;background-color:#ffe431;color:rgba(39,40,50,.6);border-radius:%?20?%}.main .apply .friend-list .friend-list-l uni-image[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-l uni-image[data-v-669e11d6]{width:%?96?%;height:%?96?%;border-radius:%?20?%}.main .apply .friend-list .friend-list-l .tip[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-l .tip[data-v-669e11d6]{z-index:10;position:absolute;top:%?-6?%;left:%?68?%;padding:0 %?6?%;min-width:%?22?%;height:%?36?%;background:#ff5d5b;border-radius:%?18?%;font-size:%?24?%;color:#fff;line-height:%?36?%;text-align:center;box-shadow:%?8?% %?10?% %?25?% %?-5?% rgba(117,112,117,.3)}.main .apply .friend-list .friend-list-r[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-r[data-v-669e11d6]{padding-left:%?120?%}.main .apply .friend-list .friend-list-r .top[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-r .top[data-v-669e11d6]{height:%?50?%}.main .apply .friend-list .friend-list-r .top .name[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-r .top .name[data-v-669e11d6]{float:left;font-size:%?36?%;font-weight:400;color:#272832;line-height:%?50?%}.main .apply .friend-list .friend-list-r .top .time[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-r .top .time[data-v-669e11d6]{float:right;font-size:%?24?%;color:rgba(39,40,50,.4);line-height:%?50?%}.main .apply .friend-list .friend-list-r .news[data-v-669e11d6],\r\n.main .friends .friend-list .friend-list-r .news[data-v-669e11d6]{font-size:%?28?%;color:rgba(39,40,50,.6);line-height:%?40?%;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;overflow:hidden}',""]),i.exports=t},a093:function(i,t,e){"use strict";e.r(t);var n=e("6ef9"),a=e.n(n);for(var r in n)"default"!==r&&function(i){e.d(t,i,(function(){return n[i]}))}(r);t["default"]=a.a},b503:function(i,t,e){"use strict";e.r(t);var n=e("418e"),a=e("a093");for(var r in a)"default"!==r&&function(i){e.d(t,i,(function(){return a[i]}))}(r);e("8270");var s,d=e("f0c5"),o=Object(d["a"])(a["default"],n["b"],n["c"],!1,null,"669e11d6",null,!1,n["a"],s);t["default"]=o.exports},ebc6:function(i,t,e){var n=e("9304");"string"===typeof n&&(n=[[i.i,n,""]]),n.locals&&(i.exports=n.locals);var a=e("4f06").default;a("8ec2ecc2",n,!0,{sourceMap:!1,shadowMode:!1})}}]);